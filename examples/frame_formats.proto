// Frame Format Definitions for struct-frame
// Defines message framing formats for communication over serial, network, or byte streams.

package frame_formats;

// Frame format type enumeration
enum FrameFormatType {
  NO_FORMAT = 0;
  MSG_ID_FRAME = 1;
  MSG_ID_FRAME_NO_CRC = 2;
  BASIC_FRAME = 3;
  BASIC_FRAME_NO_CRC = 4;
  TINY_FRAME = 5;
  TINY_FRAME_NO_CRC = 6;
  MSG_ID_FRAME_LEN8 = 7;
  MSG_ID_FRAME_LEN8_NO_CRC = 8;
  MSG_ID_FRAME_LEN16 = 9;
  MSG_ID_FRAME_LEN16_NO_CRC = 10;
  BASIC_FRAME_WITH_LEN = 11;
  BASIC_FRAME_LEN8_NO_CRC = 12;
  BASIC_FRAME_LEN16 = 13;
  BASIC_FRAME_LEN16_NO_CRC = 14;
  TINY_FRAME_LEN8 = 15;
  TINY_FRAME_LEN8_NO_CRC = 16;
  TINY_FRAME_LEN16 = 17;
  TINY_FRAME_LEN16_NO_CRC = 18;
  UBX = 19;
  MAVLINK_V1 = 20;
  MAVLINK_V2 = 21;
}

// Basic message payload included in all frame formats
message BasicMessage {
  uint8 msg_id = 1;
}

// ============================================================================
// NO FORMAT - Raw message, no framing
// Format: [MSG]
// Overhead: 0 bytes
message NoFormat {
  BasicMessage payload = 1;
}

// ============================================================================
// MSG ID FRAME - Minimal framing with CRC
// Format: [MSG_ID] [MSG] [CRC1] [CRC2]
// Overhead: 3 bytes
message MsgIdFrame {
  BasicMessage payload = 1;
  uint8 crc_byte1 = 2;
  uint8 crc_byte2 = 3;
}

// MSG ID FRAME NO CRC
// Format: [MSG_ID] [MSG]
// Overhead: 1 byte
message MsgIdFrameNoCrc {
  BasicMessage payload = 1;
}

// ============================================================================
// BASIC FRAME - Standard framing with sync and CRC (Recommended)
// Format: [START=0x90] [MSG_ID] [MSG] [CRC1] [CRC2]
// Overhead: 4 bytes
message BasicFrame {
  uint8 start_byte = 1 [(hex) = 0x90];
  BasicMessage payload = 2;
  uint8 crc_byte1 = 3;
  uint8 crc_byte2 = 4;
}

// BASIC FRAME NO CRC
// Format: [START=0x90] [MSG_ID] [MSG]
// Overhead: 2 bytes
message BasicFrameNoCrc {
  uint8 start_byte = 1 [(hex) = 0x90];
  BasicMessage payload = 2;
}

// ============================================================================
// TINY FRAME - Compact framing for constrained environments
// Format: [START] [MSG_ID] [MSG] [CRC1] [CRC2]
// Overhead: 4 bytes
message TinyFrame {
  uint8 start_byte = 1 [(hex) = 0x90];
  BasicMessage payload = 2;
  uint8 crc_byte1 = 3;
  uint8 crc_byte2 = 4;
}

// TINY FRAME NO CRC
// Format: [START] [MSG_ID] [MSG]
// Overhead: 2 bytes
message TinyFrameNoCrc {
  uint8 start_byte = 1 [(hex) = 0x90];
  BasicMessage payload = 2;
}

// ============================================================================
// LENGTH-PREFIXED VARIANTS (8-bit length, up to 255 bytes)
// ============================================================================

// MSG ID FRAME LEN8
// Format: [MSG_ID] [LEN] [MSG] [CRC1] [CRC2]
// Overhead: 4 bytes
message MsgIdFrameLen8 {
  BasicMessage payload = 1;
  uint8 length = 2;
  uint8 crc_byte1 = 3;
  uint8 crc_byte2 = 4;
}

// MSG ID FRAME LEN8 NO CRC
// Format: [MSG_ID] [LEN] [MSG]
// Overhead: 2 bytes
message MsgIdFrameLen8NoCrc {
  BasicMessage payload = 1;
  uint8 length = 2;
}

// BASIC FRAME WITH LEN (Recommended for variable length)
// Format: [START=0x90] [MSG_ID] [LEN] [MSG] [CRC1] [CRC2]
// Overhead: 5 bytes
message BasicFrameWithLen {
  uint8 start_byte = 1 [(hex) = 0x90];
  BasicMessage payload = 2;
  uint8 length = 3;
  uint8 crc_byte1 = 4;
  uint8 crc_byte2 = 5;
}

// BASIC FRAME LEN8 NO CRC
// Format: [START=0x90] [MSG_ID] [LEN] [MSG]
// Overhead: 3 bytes
message BasicFrameLen8NoCrc {
  uint8 start_byte = 1 [(hex) = 0x90];
  BasicMessage payload = 2;
  uint8 length = 3;
}

// TINY FRAME LEN8
// Format: [START] [MSG_ID] [LEN] [MSG] [CRC1] [CRC2]
// Overhead: 5 bytes
message TinyFrameLen8 {
  uint8 start_byte = 1 [(hex) = 0x90];
  BasicMessage payload = 2;
  uint8 length = 3;
  uint8 crc_byte1 = 4;
  uint8 crc_byte2 = 5;
}

// TINY FRAME LEN8 NO CRC
// Format: [START] [MSG_ID] [LEN] [MSG]
// Overhead: 3 bytes
message TinyFrameLen8NoCrc {
  uint8 start_byte = 1 [(hex) = 0x90];
  BasicMessage payload = 2;
  uint8 length = 3;
}

// ============================================================================
// LENGTH-PREFIXED VARIANTS (16-bit length, up to 65535 bytes)
// ============================================================================

// MSG ID FRAME LEN16
// Format: [MSG_ID] [LEN_LO] [LEN_HI] [MSG] [CRC1] [CRC2]
// Overhead: 5 bytes
message MsgIdFrameLen16 {
  BasicMessage payload = 1;
  uint16 length = 2;
  uint8 crc_byte1 = 3;
  uint8 crc_byte2 = 4;
}

// MSG ID FRAME LEN16 NO CRC
// Format: [MSG_ID] [LEN_LO] [LEN_HI] [MSG]
// Overhead: 3 bytes
message MsgIdFrameLen16NoCrc {
  BasicMessage payload = 1;
  uint16 length = 2;
}

// BASIC FRAME LEN16
// Format: [START=0x90] [MSG_ID] [LEN_LO] [LEN_HI] [MSG] [CRC1] [CRC2]
// Overhead: 6 bytes
message BasicFrameLen16 {
  uint8 start_byte = 1 [(hex) = 0x90];
  BasicMessage payload = 2;
  uint16 length = 3;
  uint8 crc_byte1 = 4;
  uint8 crc_byte2 = 5;
}

// BASIC FRAME LEN16 NO CRC
// Format: [START=0x90] [MSG_ID] [LEN_LO] [LEN_HI] [MSG]
// Overhead: 4 bytes
message BasicFrameLen16NoCrc {
  uint8 start_byte = 1 [(hex) = 0x90];
  BasicMessage payload = 2;
  uint16 length = 3;
}

// TINY FRAME LEN16
// Format: [START] [MSG_ID] [LEN_LO] [LEN_HI] [MSG] [CRC1] [CRC2]
// Overhead: 6 bytes
message TinyFrameLen16 {
  uint8 start_byte = 1 [(hex) = 0x90];
  BasicMessage payload = 2;
  uint16 length = 3;
  uint8 crc_byte1 = 4;
  uint8 crc_byte2 = 5;
}

// TINY FRAME LEN16 NO CRC
// Format: [START] [MSG_ID] [LEN_LO] [LEN_HI] [MSG]
// Overhead: 4 bytes
message TinyFrameLen16NoCrc {
  uint8 start_byte = 1 [(hex) = 0x90];
  BasicMessage payload = 2;
  uint16 length = 3;
}

// ============================================================================
// THIRD PARTY PROTOCOLS
// ============================================================================

// UBX FRAME - u-blox GPS/GNSS protocol
// Format: [SYNC1=0xB5] [SYNC2=0x62] [CLASS] [ID] [LEN_LO] [LEN_HI] [MSG] [CK_A] [CK_B]
// Overhead: 8 bytes
message UbxFrame {
  uint8 sync1 = 1 [(hex) = 0xB5];
  uint8 sync2 = 2 [(hex) = 0x62];
  uint8 msg_class = 3;
  uint8 msg_id = 4;
  uint8 length_lo = 5;
  uint8 length_hi = 6;
  uint8 ck_a = 7;
  uint8 ck_b = 8;
}

// MAVLINK V1 FRAME - Legacy drone protocol
// Format: [STX=0xFE] [LEN] [SEQ] [SYS] [COMP] [MSG] [PAYLOAD] [CRC_LO] [CRC_HI]
// Overhead: 8 bytes
message MavlinkV1Frame {
  uint8 stx = 1 [(hex) = 0xFE];
  uint8 length = 2;
  uint8 sequence = 3;
  uint8 system_id = 4;
  uint8 component_id = 5;
  uint8 msg_id = 6;
  uint8 crc_lo = 7;
  uint8 crc_hi = 8;
}

// MAVLINK V2 FRAME - Modern drone protocol with extended message IDs
// Format: [STX=0xFD] [LEN] [INCOMPAT] [COMPAT] [SEQ] [SYS] [COMP] [MSG_ID x3] [PAYLOAD] [CRC] [SIG?]
// Overhead: 12-25 bytes
message MavlinkV2Frame {
  uint8 stx = 1 [(hex) = 0xFD];
  uint8 length = 2;
  uint8 incompat_flags = 3;
  uint8 compat_flags = 4;
  uint8 sequence = 5;
  uint8 system_id = 6;
  uint8 component_id = 7;
  uint8 msg_id_0 = 8;
  uint8 msg_id_1 = 9;
  uint8 msg_id_2 = 10;
  uint8 crc_lo = 11;
  uint8 crc_hi = 12;
}

// MAVLINK V2 SIGNATURE - Optional authentication (13 bytes)
message MavlinkV2Signature {
  uint8 link_id = 1;
  uint8 timestamp_0 = 2;
  uint8 timestamp_1 = 3;
  uint8 timestamp_2 = 4;
  uint8 timestamp_3 = 5;
  uint8 timestamp_4 = 6;
  uint8 timestamp_5 = 7;
  uint8 signature_0 = 8;
  uint8 signature_1 = 9;
  uint8 signature_2 = 10;
  uint8 signature_3 = 11;
  uint8 signature_4 = 12;
  uint8 signature_5 = 13;
}

// ============================================================================
// CONFIGURATION
// ============================================================================

// Runtime frame format configuration
message FrameFormatConfig {
  FrameFormatType format_type = 1;
  uint8 start_byte = 2 [(hex) = 0x90];
  uint8 start_byte_2 = 3 [(hex) = 0x62];
  bool crc_enabled = 4;
  bool signing_enabled = 5;
}
